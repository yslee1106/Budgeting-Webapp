{% extends "base.html" %}

{% block title %} Notifications {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
    <div class="content">
        <div class="col-12">
            <div class="row"></div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-2">
                            <button type="button" class="close">
                                <div class="col">
                                    <p>&lt</p>
                                </div>
                            </button>
                        </div>
                        <div class="col-md-8">
                            <div class="table-responsive table-full-width">
                                <table class="table">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="calandar calandar-primary">
                                                    <button type="button" class="close">
                                                        <div class="col">
                                                            <p>Month</p>
                                                            <p>Year</p>
                                                        </div>
                                                        
                                                    </button>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="calandar calandar-primary">
                                                    <button type="button" class="close">
                                                        <div class="col">
                                                            <p>Month</p>
                                                            <p>Year</p>
                                                        </div>
                                                        
                                                    </button>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="calandar calandar-primary">
                                                    <button type="button" class="close">
                                                        <div class="col">
                                                            <p>Month</p>
                                                            <p>Year</p>
                                                        </div>
                                                        
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <button type="button" class="close">
                                <div class="col">
                                    <p>&gt</p>
                                </div>
                            </button>
                        </div>
                    </div>
                    
                </div>
            </div>

            <div class="row">
                <div class="col-4">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Funds</h2>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-6">
                                    <h4>Budget</h4>
                                </div>
                                <div class="col-sm-6">
                                    <h4>0000.00</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6">
                                    <h4>Spent</h4>
                                </div>
                                <div class="col-sm-6">
                                    <h4>0000.00</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6">
                                    <h4>Available</h4>
                                </div>
                                <div class="col-sm-6">
                                    <h4>0000.00</h4>
                                </div>
                            </div>
                        </div>
                    </div>  
        
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Goals </h2>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive table-full-width ">
                                <table class="table">
                                    <thead class="text-primary">
                                        <tr>
                                            <th>Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="slider-container">
                                                    <input type="number" class="slider-number-input" value="50" min="0" max="100" step="1">
                                                    <input type="range" class="custom-slider" min="0" max="100" value="50" step="1">
                                                    <span class="slider-max-value">100</span>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-8">
                    <div class="card card-expenses">
                        <div class="card-header">
                            <h2 class="card-title">Expenses</h2>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive table-full-width ">
                                <table class="table">  
                                    <tbody>
                                        <th>Category</th>
                                        <tr>
                                            <td>Name</td>
                                            <td>
                                                <div class="slider-container">
                                                    <input type="number" class="slider-number-input" value="50" min="0" max="100" step="1">
                                                    <input type="range" class="custom-slider" min="0" max="100" value="50" step="1">
                                                    <span class="slider-max-value">100</span>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize PerfectScrollbar on the table container
         // Function to initialize PerfectScrollbar for a given container
        function initializePerfectScrollbar(container) {
        const ps = new PerfectScrollbar(container, {
            wheelSpeed: 2, // Adjust scroll speed
            wheelPropagation: true, // Allow wheel event propagation
            minScrollbarLength: 20, // Minimum scrollbar length
        });

        // Return the PerfectScrollbar instance for future updates
        return ps;
        }

        // Initialize PerfectScrollbar for all table containers
        const tableContainers = document.querySelectorAll('.table-responsive');
        const psInstances = [];

        tableContainers.forEach((container) => {
        const ps = initializePerfectScrollbar(container);
        psInstances.push(ps); // Store the instance for future updates
        });

        function updateSlider(slider, newValue) {
            const container = slider.closest('.slider-container');
            const numberInput = container.querySelector('.slider-number-input');
            const maxValue = container.querySelector('.slider-max-value');
            
            // Clamp value to valid range
            const clampedValue = Math.max(slider.min, Math.min(slider.max, newValue));
            
            // Update slider and input
            slider.value = clampedValue;
            numberInput.value = clampedValue;
            
            // Store last valid value on the input element
            numberInput.dataset.lastValid = clampedValue;
            
            // Update track gradient
            const percentage = (clampedValue / slider.max) * 100;
            slider.style.background = 
                `linear-gradient(to right, yellow ${percentage}%, #ccc ${percentage}%)`;
        }

        function initializeSliders() {
            document.querySelectorAll('.custom-slider').forEach(slider => {
                const container = slider.closest('.slider-container');
                const numberInput = container.querySelector('.slider-number-input');
                const maxValue = container.querySelector('.slider-max-value');

                // Set initial max value
                maxValue.textContent = slider.max;
                numberInput.dataset.lastValid = slider.value;

                // Slider events
                slider.addEventListener('input', () => {
                    updateSlider(slider, slider.value);
                });

                // Number input events
                numberInput.addEventListener('input', (e) => {
                    const value = parseFloat(e.target.value);
                    
                    if (!isNaN(value)) {
                        updateSlider(slider, value);
                    } else if (e.target.value === '') {
                        // Allow empty input but keep last valid value
                        numberInput.value = '';
                        return;
                    } else {
                        // Revert to last valid value
                        numberInput.value = numberInput.dataset.lastValid;
                    }
                });

                numberInput.addEventListener('blur', (e) => {
                    if (e.target.value === '') {
                        // Restore last valid value when focus is lost
                        e.target.value = numberInput.dataset.lastValid;
                    }
                });

                // Initial update
                updateSlider(slider, slider.value);
            });
        }

        initializeSliders();
    </script>
{% endblock javascripts %}
   
